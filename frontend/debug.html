<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Debug OfertaPrimeX</title>
<style>
body { margin:0; display:flex; height:100vh; font-family:Arial; background:#0f172a; color:#e5e7eb }
#menu { width:260px; background:#020617; padding:20px }
#menu button { width:100%; margin-bottom:8px; padding:10px; cursor:pointer }
#content { flex:1; padding:20px }
input { width:100%; padding:8px; margin-bottom:8px }
</style>
</head>

<body>

<div id="menu">
  <h3>Login Debug</h3>
  <input id="user" placeholder="Usuário">
  <input id="pass" type="password" placeholder="Senha">
  <button onclick="login()">Entrar</button>

  <hr>

  <button onclick="call('/debug/status')">Status</button>
  <button onclick="call('/debug/db')">Banco</button>
  <button onclick="call('/debug/db/tabelas')">Tabelas</button>
  <button onclick="call('/debug/db/insert-teste')">Inserir Produto</button>
  <button onclick="call('/debug/produtos')">Listar Produtos</button>
</div>

<div id="content">
  <pre id="out">Faça login</pre>
</div>

<script>
const API = 'https://yo0g0cg4c88w88osc4s04c0c.72.61.33.248.sslip.io;
let TOKEN = localStorage.getItem('debug_token');

function out(t) {
  document.getElementById('out').textContent = t;
}

async function login() {
  const res = await fetch(API + '/debug/login', {
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
      user: user.value,
      pass: pass.value
    })
  });

  const data = await res.json();

  if (data.token) {
    TOKEN = data.token;
    localStorage.setItem('debug_token', TOKEN);
    out('✅ Login efetuado');
  } else {
    out('❌ Login inválido');
  }
}

async function call(path) {
  if (!TOKEN) return out('❌ Faça login primeiro');

  const r = await fetch(API + path, {
    headers:{ Authorization: TOKEN }
  });

  const d = await r.json();
  out(JSON.stringify(d, null, 2));
}
</script>
</body>
</html>
